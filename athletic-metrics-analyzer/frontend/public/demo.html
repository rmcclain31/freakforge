<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Athletic Metrics Analyzer</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #0f172a;
            color: #e2e8f0;
        }

        .app-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        .header {
            background: #1e293b;
            padding: 1rem 2rem;
            border-bottom: 2px solid #334155;
        }

        .header h1 {
            font-size: 1.5rem;
            color: #60a5fa;
        }

        .main-tabs {
            background: #1e293b;
            display: flex;
            gap: 0.5rem;
            padding: 0 2rem;
            border-bottom: 1px solid #334155;
        }

        .tab-button {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            color: #94a3b8;
            cursor: pointer;
            font-size: 0.95rem;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }

        .tab-button:hover {
            color: #e2e8f0;
            background: #334155;
        }

        .tab-button.active {
            color: #60a5fa;
            border-bottom-color: #60a5fa;
        }

        .content-area {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .sidebar {
            width: 220px;
            background: #1e293b;
            border-right: 1px solid #334155;
            padding: 1rem;
            overflow-y: auto;
        }

        .sidebar-section {
            margin-bottom: 1.5rem;
        }

        .sidebar-section h3 {
            font-size: 0.75rem;
            text-transform: uppercase;
            color: #64748b;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .sidebar-item {
            padding: 0.6rem 0.8rem;
            margin-bottom: 0.25rem;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.9rem;
            color: #cbd5e1;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .sidebar-item:hover {
            background: #334155;
            color: #e2e8f0;
        }

        .sidebar-item.active {
            background: #1e40af;
            color: #fff;
        }

        .main-content {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        .center-panel {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }

        .right-panel {
            width: 320px;
            background: #1e293b;
            border-left: 1px solid #334155;
            padding: 1.5rem;
            overflow-y: auto;
        }

        .right-panel h2 {
            font-size: 1.1rem;
            color: #60a5fa;
            margin-bottom: 1rem;
        }

        .metric-input-group {
            margin-bottom: 1.5rem;
        }

        .metric-input-group label {
            display: block;
            font-size: 0.85rem;
            color: #94a3b8;
            margin-bottom: 0.4rem;
        }

        .metric-input-group input {
            width: 100%;
            padding: 0.6rem;
            background: #0f172a;
            border: 1px solid #334155;
            border-radius: 0.375rem;
            color: #e2e8f0;
            font-size: 0.9rem;
        }

        .metric-input-group input:focus {
            outline: none;
            border-color: #60a5fa;
        }

        .radar-container {
            background: #1e293b;
            padding: 2rem;
            border-radius: 0.5rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .bell-curve-container {
            background: #1e293b;
            padding: 2rem;
            border-radius: 0.5rem;
            margin-bottom: 2rem;
        }

        .button {
            padding: 0.6rem 1.2rem;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.2s;
        }

        .button:hover {
            background: #1d4ed8;
        }

        .button-secondary {
            background: #334155;
        }

        .button-secondary:hover {
            background: #475569;
        }

        .metric-category {
            margin-bottom: 2rem;
        }

        .metric-category h3 {
            color: #60a5fa;
            font-size: 1.1rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #334155;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
        }

        .metric-card {
            background: #0f172a;
            padding: 1rem;
            border-radius: 0.375rem;
            border: 1px solid #334155;
        }

        .metric-card .metric-name {
            font-size: 0.85rem;
            color: #94a3b8;
            margin-bottom: 0.5rem;
        }

        .metric-card .metric-value {
            font-size: 1.3rem;
            color: #e2e8f0;
            font-weight: 600;
        }

        .drag-drop-zone {
            border: 2px dashed #334155;
            border-radius: 0.375rem;
            padding: 1.5rem;
            text-align: center;
            color: #64748b;
            margin-bottom: 1rem;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .drag-drop-zone:hover {
            border-color: #60a5fa;
            background: #0f172a;
        }

        .metric-chip {
            display: inline-block;
            padding: 0.4rem 0.8rem;
            background: #1e40af;
            color: white;
            border-radius: 1rem;
            font-size: 0.85rem;
            margin: 0.25rem;
            cursor: grab;
        }

        .metric-chip:active {
            cursor: grabbing;
        }

        .operator-buttons {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .operator-btn {
            padding: 0.5rem 1rem;
            background: #334155;
            border: 1px solid #475569;
            color: #e2e8f0;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .operator-btn:hover {
            background: #475569;
        }

        canvas {
            max-width: 100%;
        }

        .bell-curve-svg {
            width: 100%;
            height: 300px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Define athletic metrics
        const ATHLETIC_METRICS = {
            speedPower: [
                { id: 'dash40', name: '40-Yard Dash', unit: 'sec', measure: 'Speed/Acceleration' },
                { id: 'verticalJump', name: 'Vertical Jump', unit: 'in', measure: 'Explosive leg power' },
                { id: 'broadJump', name: 'Broad Jump', unit: 'in', measure: 'Horizontal power' }
            ],
            agility: [
                { id: 'proAgility', name: 'Pro Agility (5-10-5)', unit: 'sec', measure: 'Lateral quickness' },
                { id: 'lDrill', name: 'L-Drill (3-Cone)', unit: 'sec', measure: 'Change of direction' }
            ],
            strength: [
                { id: 'benchPress', name: 'Bench Press', unit: 'lbs', measure: 'Upper body strength' },
                { id: 'squat', name: 'Squat', unit: 'lbs', measure: 'Lower body strength' }
            ],
            bodyMeasurements: [
                { id: 'height', name: 'Height', unit: 'in', measure: 'Physical measurements' },
                { id: 'weight', name: 'Weight', unit: 'lbs', measure: 'Physical measurements' },
                { id: 'bodyFat', name: 'Body Fat %', unit: '%', measure: 'Body composition' },
                { id: 'wingspan', name: 'Wing Span', unit: 'in', measure: 'Arm length/reach' },
                { id: 'handSize', name: 'Hand Measurement', unit: 'in', measure: 'Hand size' }
            ]
        };

        // Standard calculated metrics
        const calculateStandardMetrics = (data) => {
            const calculated = {};
            
            if (data.verticalJump && data.weight) {
                calculated.verticalToWeight = (data.verticalJump / data.weight).toFixed(4);
            }
            if (data.broadJump && data.weight) {
                calculated.broadToWeight = (data.broadJump / data.weight).toFixed(4);
            }
            if (data.benchPress && data.weight) {
                calculated.relativeStrength = (data.benchPress / data.weight).toFixed(4);
            }
            if (data.squat && data.weight) {
                calculated.squatToWeight = (data.squat / data.weight).toFixed(4);
            }
            if (data.wingspan && data.height) {
                calculated.wingspanRatio = (data.wingspan / data.height).toFixed(4);
            }
            if (data.dash40 && data.weight) {
                calculated.speedForSize = (data.weight / data.dash40).toFixed(4);
            }
            
            return calculated;
        };

        function Dashboard({ athleteData }) {
            const chartRef = useRef(null);
            const chartInstance = useRef(null);

            useEffect(() => {
                if (chartRef.current && Object.keys(athleteData).length > 0) {
                    const ctx = chartRef.current.getContext('2d');
                    
                    if (chartInstance.current) {
                        chartInstance.current.destroy();
                    }

                    // Default 8 metrics for radar
                    const defaultMetrics = [
                        { key: 'dash40', label: '40-Yard Dash', value: athleteData.dash40 || 0, inverse: true },
                        { key: 'verticalJump', label: 'Vertical Jump', value: athleteData.verticalJump || 0 },
                        { key: 'broadJump', label: 'Broad Jump', value: athleteData.broadJump || 0 },
                        { key: 'proAgility', label: 'Pro Agility', value: athleteData.proAgility || 0, inverse: true },
                        { key: 'benchPress', label: 'Bench Press', value: athleteData.benchPress || 0 },
                        { key: 'squat', label: 'Squat', value: athleteData.squat || 0 },
                        { key: 'wingspan', label: 'Wingspan', value: athleteData.wingspan || 0 },
                        { key: 'weight', label: 'Weight', value: athleteData.weight || 0 }
                    ];

                    // Normalize values to 0-100 scale (simplified for now)
                    const normalizedData = defaultMetrics.map(m => {
                        if (!m.value) return 0;
                        // Inverse for times (lower is better)
                        if (m.inverse) {
                            return Math.max(0, 100 - (m.value * 10));
                        }
                        return Math.min(100, m.value);
                    });

                    chartInstance.current = new Chart(ctx, {
                        type: 'radar',
                        data: {
                            labels: defaultMetrics.map(m => m.label),
                            datasets: [{
                                label: 'Athlete Performance',
                                data: normalizedData,
                                backgroundColor: 'rgba(96, 165, 250, 0.2)',
                                borderColor: 'rgba(96, 165, 250, 1)',
                                borderWidth: 2,
                                pointBackgroundColor: 'rgba(96, 165, 250, 1)',
                                pointBorderColor: '#fff',
                                pointHoverBackgroundColor: '#fff',
                                pointHoverBorderColor: 'rgba(96, 165, 250, 1)'
                            }]
                        },
                        options: {
                            scales: {
                                r: {
                                    beginAtZero: true,
                                    max: 100,
                                    ticks: {
                                        color: '#94a3b8',
                                        backdropColor: 'transparent'
                                    },
                                    grid: {
                                        color: '#334155'
                                    },
                                    pointLabels: {
                                        color: '#e2e8f0',
                                        font: {
                                            size: 11
                                        }
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    labels: {
                                        color: '#e2e8f0'
                                    }
                                }
                            }
                        }
                    });
                }

                return () => {
                    if (chartInstance.current) {
                        chartInstance.current.destroy();
                    }
                };
            }, [athleteData]);

            return (
                <div className="center-panel">
                    <h2 style={{marginBottom: '2rem', fontSize: '1.5rem'}}>Performance Dashboard</h2>
                    <div className="radar-container">
                        <canvas ref={chartRef}></canvas>
                    </div>
                </div>
            );
        }

        function MetricExplorer({ athleteData, viewMode }) {
            const bellCurveRef = useRef(null);

            useEffect(() => {
                if (bellCurveRef.current && viewMode === 'freak') {
                    // Draw bell curve with D3 or Canvas
                    const canvas = bellCurveRef.current;
                    const ctx = canvas.getContext('2d');
                    const width = canvas.width;
                    const height = canvas.height;

                    ctx.clearRect(0, 0, width, height);

                    // Draw bell curve
                    ctx.strokeStyle = '#475569';
                    ctx.lineWidth = 2;
                    ctx.beginPath();

                    for (let x = 0; x < width; x++) {
                        const t = (x / width) * 8 - 4; // -4 to +4 sigma
                        const y = height * 0.8 - (height * 0.6 * Math.exp(-(t * t) / 2));
                        if (x === 0) {
                            ctx.moveTo(x, y);
                        } else {
                            ctx.lineTo(x, y);
                        }
                    }
                    ctx.stroke();

                    // Draw sigma markers
                    ctx.strokeStyle = '#334155';
                    ctx.lineWidth = 1;
                    ctx.font = '10px sans-serif';
                    ctx.fillStyle = '#64748b';
                    
                    for (let sigma = -3; sigma <= 3; sigma += 0.5) {
                        const x = width / 2 + (sigma * width / 8);
                        const tickHeight = sigma % 1 === 0 ? 20 : 10;
                        ctx.beginPath();
                        ctx.moveTo(x, height * 0.8);
                        ctx.lineTo(x, height * 0.8 + tickHeight);
                        ctx.stroke();
                        
                        if (sigma % 1 === 0) {
                            ctx.fillText(sigma > 0 ? `+${sigma}œÉ` : `${sigma}œÉ`, x - 12, height * 0.8 + 35);
                        }
                    }

                    // Simulate data points (will be real calculations)
                    const calculated = calculateStandardMetrics(athleteData);
                    const points = [];
                    
                    // Example: place vertical/weight at a certain sigma position
                    if (calculated.verticalToWeight) {
                        // Simulated sigma position (would be actual calculation)
                        const sigma = 1.5;
                        const x = width / 2 + (sigma * width / 8);
                        const jitter = (Math.random() - 0.5) * 30;
                        const y = height * 0.8 - (height * 0.6 * Math.exp(-(sigma * sigma) / 2)) + jitter;
                        
                        ctx.fillStyle = '#60a5fa';
                        ctx.beginPath();
                        ctx.arc(x, y, 4, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }
            }, [athleteData, viewMode]);

            return (
                <div className="center-panel">
                    {viewMode === 'raw' && (
                        <div>
                            <h2 style={{marginBottom: '2rem', fontSize: '1.5rem'}}>Raw Metrics</h2>
                            {Object.entries(ATHLETIC_METRICS).map(([category, metrics]) => (
                                <div key={category} className="metric-category">
                                    <h3>{category.replace(/([A-Z])/g, ' $1').trim()}</h3>
                                    <div className="metrics-grid">
                                        {metrics.map(metric => (
                                            <div key={metric.id} className="metric-card">
                                                <div className="metric-name">{metric.name}</div>
                                                <div className="metric-value">
                                                    {athleteData[metric.id] || '--'} {athleteData[metric.id] ? metric.unit : ''}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}
                    
                    {viewMode === 'standard' && (
                        <div>
                            <h2 style={{marginBottom: '2rem', fontSize: '1.5rem'}}>Standard Ratios</h2>
                            <div className="metrics-grid">
                                {Object.entries(calculateStandardMetrics(athleteData)).map(([key, value]) => (
                                    <div key={key} className="metric-card">
                                        <div className="metric-name">{key.replace(/([A-Z])/g, ' $1').trim()}</div>
                                        <div className="metric-value">{value}</div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                    
                    {viewMode === 'freak' && (
                        <div>
                            <h2 style={{marginBottom: '2rem', fontSize: '1.5rem'}}>Freak Finder Analysis</h2>
                            <div className="bell-curve-container">
                                <canvas ref={bellCurveRef} width="800" height="300" className="bell-curve-svg"></canvas>
                                <p style={{textAlign: 'center', color: '#64748b', marginTop: '1rem', fontSize: '0.85rem'}}>
                                    Hover over data points to see metric formulas. Click to view detailed histogram.
                                </p>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        function MetricBuilder({ athleteData, onMetricCreated }) {
            const [numerator, setNumerator] = useState([]);
            const [denominator, setDenominator] = useState([]);

            const allMetrics = Object.values(ATHLETIC_METRICS).flat();

            return (
                <div className="right-panel">
                    <h2>Metric Builder</h2>
                    
                    <div style={{marginBottom: '1.5rem'}}>
                        <h4 style={{fontSize: '0.85rem', color: '#94a3b8', marginBottom: '0.5rem'}}>Available Metrics</h4>
                        <div>
                            {allMetrics.map(metric => (
                                <span key={metric.id} className="metric-chip" draggable>
                                    {metric.name}
                                </span>
                            ))}
                        </div>
                    </div>

                    <div style={{marginBottom: '1rem'}}>
                        <label style={{fontSize: '0.85rem', color: '#94a3b8', display: 'block', marginBottom: '0.5rem'}}>
                            Numerator
                        </label>
                        <div className="drag-drop-zone">
                            {numerator.length === 0 ? 'Drag metrics here' : numerator.join(' √ó ')}
                        </div>
                    </div>

                    <div style={{marginBottom: '1rem'}}>
                        <label style={{fontSize: '0.85rem', color: '#94a3b8', display: 'block', marginBottom: '0.5rem'}}>
                            Denominator
                        </label>
                        <div className="drag-drop-zone">
                            {denominator.length === 0 ? 'Drag metrics here' : denominator.join(' √ó ')}
                        </div>
                    </div>

                    <div className="operator-buttons">
                        <button className="operator-btn">√ó Multiply</button>
                        <button className="operator-btn">√∑ Divide</button>
                        <button className="operator-btn">^ Power</button>
                        <button className="operator-btn">‚àö Root</button>
                    </div>

                    <button className="button" style={{width: '100%'}}>
                        Create Custom Metric
                    </button>
                </div>
            );
        }

        function DataInput({ athleteData, onDataChange }) {
            const allMetrics = Object.values(ATHLETIC_METRICS).flat();

            return (
                <div className="right-panel">
                    <h2>Athlete Data</h2>
                    {allMetrics.map(metric => (
                        <div key={metric.id} className="metric-input-group">
                            <label>{metric.name} ({metric.unit})</label>
                            <input
                                type="number"
                                step="0.01"
                                value={athleteData[metric.id] || ''}
                                onChange={(e) => onDataChange(metric.id, e.target.value)}
                                placeholder={`Enter ${metric.name.toLowerCase()}`}
                            />
                        </div>
                    ))}
                </div>
            );
        }

        function App() {
            const [activeTab, setActiveTab] = useState('dashboard');
            const [explorerView, setExplorerView] = useState('raw');
            const [athleteData, setAthleteData] = useState({});

            const handleDataChange = (metricId, value) => {
                setAthleteData(prev => ({
                    ...prev,
                    [metricId]: parseFloat(value) || 0
                }));
            };

            return (
                <div className="app-container">
                    <div className="header">
                        <h1>‚ö° Athletic Metrics Analyzer</h1>
                    </div>

                    <div className="main-tabs">
                        <button 
                            className={`tab-button ${activeTab === 'dashboard' ? 'active' : ''}`}
                            onClick={() => setActiveTab('dashboard')}
                        >
                            Dashboard
                        </button>
                        <button 
                            className={`tab-button ${activeTab === 'explorer' ? 'active' : ''}`}
                            onClick={() => setActiveTab('explorer')}
                        >
                            Metric Explorer
                        </button>
                        <button 
                            className={`tab-button ${activeTab === 'radar' ? 'active' : ''}`}
                            onClick={() => setActiveTab('radar')}
                        >
                            Radar Charts
                        </button>
                        <button 
                            className={`tab-button ${activeTab === 'video' ? 'active' : ''}`}
                            onClick={() => setActiveTab('video')}
                        >
                            Video Analysis
                        </button>
                        <button 
                            className={`tab-button ${activeTab === 'data' ? 'active' : ''}`}
                            onClick={() => setActiveTab('data')}
                        >
                            Data Management
                        </button>
                    </div>

                    <div className="content-area">
                        {activeTab === 'explorer' && (
                            <div className="sidebar">
                                <div className="sidebar-section">
                                    <h3>View Mode</h3>
                                    <div 
                                        className={`sidebar-item ${explorerView === 'raw' ? 'active' : ''}`}
                                        onClick={() => setExplorerView('raw')}
                                    >
                                        üìä Raw Metrics
                                    </div>
                                    <div 
                                        className={`sidebar-item ${explorerView === 'standard' ? 'active' : ''}`}
                                        onClick={() => setExplorerView('standard')}
                                    >
                                        üßÆ Standard Ratios
                                    </div>
                                    <div 
                                        className={`sidebar-item ${explorerView === 'freak' ? 'active' : ''}`}
                                        onClick={() => setExplorerView('freak')}
                                    >
                                        üíé Freak Finder
                                    </div>
                                    <div 
                                        className={`sidebar-item ${explorerView === 'custom' ? 'active' : ''}`}
                                        onClick={() => setExplorerView('custom')}
                                    >
                                        ‚öôÔ∏è Custom Metrics
                                    </div>
                                </div>
                            </div>
                        )}

                        <div className="main-content">
                            {activeTab === 'dashboard' && <Dashboard athleteData={athleteData} />}
                            {activeTab === 'explorer' && <MetricExplorer athleteData={athleteData} viewMode={explorerView} />}
                            {activeTab === 'radar' && <Dashboard athleteData={athleteData} />}
                            {activeTab === 'video' && (
                                <div className="center-panel">
                                    <h2>Video Analysis Tool</h2>
                                    <p style={{color: '#94a3b8'}}>Coming soon...</p>
                                </div>
                            )}
                            {activeTab === 'data' && (
                                <div className="center-panel">
                                    <h2>Data Management</h2>
                                    <p style={{color: '#94a3b8'}}>Database import/export functionality coming soon...</p>
                                </div>
                            )}

                            {(activeTab === 'explorer' && explorerView === 'custom') ? (
                                <MetricBuilder athleteData={athleteData} />
                            ) : (
                                <DataInput athleteData={athleteData} onDataChange={handleDataChange} />
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
